<tool id="PermutationClustering" name="PermutationClustering (in docker)">
    <description>PermutationClustering function</description>
    <requirements>
	<container type="docker">rcaloger/permutationclustering</container>
    </requirements>
    <command>
 <![CDATA[
	##uncomment for test with annotated_lorenz_testSCumi_mm10.csv
	##ln -s $MatrixName ./annotated_lorenz_testSCumi_mm10.csv &&
	##Rscript $__tool_directory__/main.R annotated_lorenz_testSCumi_mm10 4 2 10 3 4 csv , 0 griph 0 10 1111 2>$log &&
	
	ln -s $MatrixName ${NameMatrix}.${Format} && 
	ln -s $__tool_directory__/functions.R . && ln -s $__tool_directory__/permutation.R . && ln -s $__tool_directory__/main.R . &&	
	Rscript main.R ${NameMatrix} $NPerm $PermAtTime $Percent $Range1 $Range2 $Format $Separator $LogTen $Clustering $Rk $Perplexity $Seed 2>$log &&
	
	tar cvzf PermutationClustering.tar.gz * 2>>$log
 
  ]]> </command>
    <inputs>
	<param format="csv" name="MatrixName" label="input matrix " type="data"/>
	<param  name="NameMatrix" label="inputMatrixname" value="annotated_lorenz_testSCumi_mm10" type="text"/>
	<param name="NPerm" value="4" label='number of permutations to perform the pValue to evaluate clustering' type="integer"/>
	<param name="PermAtTime" value="2" type="integer"/>
	<param name="Percent" value="10" type="integer"/>
	<param name="Range1" value="3" type="integer"/>
	<param name="Range2" value="4" type="integer"/>
	<param name="Format" type="select">
		<option value="csv" selected="True">csv</option>
	</param>
	<param name="Separator" value="," type="text"/>
	<param name="LogTen" value="0" type="integer"/>
	<param name="Clustering"  type="select" > 
		<option value="griph" selected="True">griph</option>
		<option value="SIMLR">SIMLR</option>
		<option value="tSne">tSne</option>
    	</param>
	<param name="Rk" value="0" type="select">
		<option value="0" selected="True">0</option>
		<option value="1">1</option>
	</param>
	<param name="Perplexity" value="10" type="integer"/>
	<param name="Seed" value="1111" type="integer"/>
    </inputs>
    <outputs>
        <data name="log" format="txt" label="logfile"/>
       <data format="tar" name="output" from_work_dir="PermutationClustering.tar.gz" label="tar result folder PermutationClustering"/>
    </outputs>
    <help>
    </help>
</tool>
